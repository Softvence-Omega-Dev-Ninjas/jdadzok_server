name: ðŸš€ CD Pipeline

on:
  workflow_run:
    workflows: ["CI Pipeline"]
    types:
      - completed
  push:
    branches:
      - main

jobs:
  docker:
    uses: ./.github/workflows/docker-build-push.yml
    secrets: inherit

  deploy:
    needs: docker
    uses: ./.github/workflows/deploy-vps.yml
    with:
      package_name: ${{ jobs.docker.outputs.package_name }}
      package_version: ${{ jobs.docker.outputs.package_version }}
    secrets: inherit
