import { Injectable } from "@nestjs/common";
import { PrismaService } from "@project/lib/prisma/prisma.service";

@Injectable()
export class FollowService {
  constructor(private readonly prisma: PrismaService) {}

  async followUser(followerId: string, followedId: string) {
    if (followerId === followedId) {
      throw new Error("Cannot follow userself");
    }
    return this.prisma.userFollow.create({
      data: {
        followerId,
        followedId,
      },
      select: {
        follower: { select: { id: true } },
        followed: { select: { id: true } },
        createdAt: true,
      },
    });
  }
}
